syntax = "proto3";

package holpaca;

service stage {
    rpc GetStatus(StatusRequest) returns (StatusResponse) {}
    rpc Resize(ResizeRequest) returns (ResizeResponse) {}
}

message ResizeRequest {
    uint64 newSize = 1;
}

message ResizeResponse {
    bool success = 1;
}

message StatusRequest {
    repeated uint64 ids = 1;
}

message StatusResponse {
    uint64 maxSize = 1;
    uint32 hits = 2;
    uint32 lookups = 3;
    map<uint64, uint32> tailAccesses = 4;
    map<uint64, double> mrc = 5;
}

service registration {
    rpc connect(ConnectRequest) returns (ConnectResponse) {}
    rpc disconnect(DisconnectRequest) returns (DisconnectResponse) {}
}

message ConnectRequest {
    string address = 1;
}

message ConnectResponse {
    bool success = 1;
}

message DisconnectRequest {
    string address = 1;
}

message DisconnectResponse {
}